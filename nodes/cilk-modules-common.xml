<?xml version="1.0" standalone="no"?>

<kickstart>

<description>
CILK
http://supertech.csail.mit.edu/cilk/
</description>

<copyright>
Copyright (c) 2000 - 2011 The Regents of the University of California.
All rights reserved. Rocks(r) v5.1 www.rocksclusters.org
</copyright>

<changelog>
</changelog>

<post>

# Remove /etc/profile.d files in favor of loadable modules when available

if test `grep -c /opt/modulefiles/compilers /etc/profile.d/modules.csh` = 0; then
  echo 'setenv MODULEPATH /opt/modulefiles/compilers:$MODULEPATH' >> \
       /etc/profile.d/modules.csh
fi
if test `grep -c /opt/modulefiles/compilers /etc/profile.d/modules.sh` = 0; then
  echo 'export MODULEPATH=/opt/modulefiles/compilers:$MODULEPATH' >> \
       /etc/profile.d/modules.sh
fi

if test -f /etc/profile.d/cilk.sh; then

  /bin/rm -f /etc/profile.d/cilk.*
  /bin/mkdir -m 0755 -p /opt/modulefiles/compilers/cilk

<file name="/opt/modulefiles/compilers/cilk/8053" perms="0644">
#%Module1.0
set packageHome /opt/cilk
setenv CILKHOME $packageHome
prepend-path PATH $packageHome/bin
</file>
<file name="/opt/modulefiles/compilers/cilk/.version.8053">
#%Module1.0
set ModulesVersion "8053"
</file>
/bin/ln -s /opt/modulefiles/compilers/cilk/.version.8053 \
           /opt/modulefiles/compilers/cilk/.version
fi

</post>

</kickstart>
